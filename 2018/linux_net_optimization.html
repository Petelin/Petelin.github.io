<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0 user-scalable=yes"/>
    <link href="/main.css" rel="stylesheet" type="text/css">
    <link href="/codehighlight.css" rel="stylesheet" type="text/css">
    <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom feed">
    <link rel="shortcut icon" href="/images/logo.bmp">
    <title></title>
</head>
<body>
  <div class="content">
  <h2>linux 系统网络栈调优</h2>

<p>默认情况下, 系统内核并没有将参数调优到大流量网络传输模式下.</p>

<p>比如</p>

<p><code>net.ipv4.tcp_max_syn_backlog</code> 代表并发连接数, 默认就很小1024.</p>

<p><code>net.core.netdev_max_backlog</code> 调大可以帮助应对网络流量突然爆发. 让更多数据在内核排队.</p>

<blockquote>
  <p>socket系统读写缓冲区</p>
</blockquote>

<p>net.core.rmem_default = 131072</p>

<p>net.core.rmem_max = 2097152</p>

<p>net.core.wmem_default = 131072</p>

<p>net.core.wmem_max = 2097152</p>

<blockquote>
  <p>tcp socket 系统读写缓冲区</p>
</blockquote>

<p>net.ipv4.tcp_rmem = 4096  65536  4088000</p>

<p>net.ipv4.tcp_wmem = 4096  65536  4088000</p>

<blockquote>
  <p>tcp时间窗扩展</p>
</blockquote>

<p>net.ipv4.tcp<em>window</em>scaling = 1</p>

<blockquote>
  <p>tcp syn队列大小</p>
</blockquote>

<p>sysctl -w net.ipv4.tcp<em>max</em>syn_backlog="2048"</p>

  </div>
</body>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106796420-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());
  gtag('config', 'UA-106796420-1');
</script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?2e8594e80b736182ce88fcd89a36402d";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
</html>